<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Подработки и зарплата</title>
<meta name="theme-color" content="#0b0d12">
<meta name="apple-mobile-web-app-capable" content="yes">
<style>
  *,*::before,*::after{box-sizing:border-box}
  :root{
    --bg:#0f1115;--card:#151922;--cardSoft:#1a1f2a;--text:#e9eef5;--muted:#9aa5b1;--line:#242a34;
    --accent:#3b82f6;--accent-bg:#1e2b49;--danger:#ef4444;--btn:#0f1320;--btnText:#e9eef5;
  }
  :root[data-theme="light"]{
    --bg:#f5f7fb;--card:#ffffff;--cardSoft:#f1f3f5;--text:#111827;--muted:#6b7280;--line:#e5e7eb;
    --accent:#2563eb;--accent-bg:#dbe7ff;--danger:#b91c1c;--btn:#ffffff;--btnText:#111827;
  }
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:12px calc(14px + env(safe-area-inset-right)) 12px calc(14px + env(safe-area-inset-left));background:#0b0d12;border-bottom:1px solid var(--line);position:sticky;top:0;z-index:5;color:#fff}
  header h1{font-size:18px;margin:0;color:#fff}
  .tabs{display:flex;gap:8px;overflow:auto;padding-bottom:4px}
  .tab{padding:10px 12px;border:1px solid rgba(255,255,255,.25);border-radius:12px;background:transparent;color:#fff;cursor:pointer;flex:0 0 auto}
  .tab.active{background:rgba(255,255,255,.18);border-color:transparent}
  main{max-width:1000px;margin:0 auto;padding:12px env(safe-area-inset-right) 24px env(safe-area-inset-left)}
  .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px;margin:12px 0;overflow:hidden}
  label{display:block;color:var(--muted);font-size:12px;margin:6px 0}
  input,select,button{font:inherit}
  input,select{width:100%;max-width:100%;min-width:0;padding:14px;border:1px solid var(--line);border-radius:12px;background:var(--btn);color:var(--btnText);min-height:44px}
  .row{display:grid;grid-template-columns:repeat(12,1fr);gap:10px}
  .col-3{grid-column:span 3}.col-4{grid-column:span 4}.col-6{grid-column:span 6}.col-12{grid-column:span 12}
  @media (max-width:860px){.col-3,.col-4,.col-6{grid-column:span 12}}
  .btn{padding:14px 16px;border-radius:12px;border:1px solid var(--line);background:var(--btn);color:var(--btnText);cursor:pointer;min-height:44px}
  .btn.primary{background:var(--accent);border-color:var(--accent);color:white}
  .btn.danger{background:#2b0f12;border-color:#4a171b;color:#ffd7db}
  .btn.small{padding:10px 12px;min-height:38px}
  .toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .toolbar.nowrap{flex-wrap:nowrap}
  .right{text-align:right}
  .muted{color:var(--muted);font-size:12px}
  .total{font-size:22px;font-weight:700}
  .table-wrap{overflow:auto;border:1px solid var(--line);border-radius:12px}
  table{width:100%;border-collapse:collapse;min-width:640px}
  th,td{padding:12px;border-bottom:1px solid var(--line);text-align:left}
  thead th{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:.04em}
  .mode-switch{display:flex;gap:8px;margin:6px 0}
  .pill{border:1px solid var(--line);background:var(--cardSoft);padding:8px 12px;border-radius:999px;cursor:pointer;color:var(--text)}
  .pill.active{background:var(--accent);color:#fff;border-color:var(--accent)}
  .quick-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
  @media (max-width:860px){.quick-grid{grid-template-columns:repeat(2,1fr)}}
  .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
  .day-head{color:var(--muted);text-align:center;font-size:12px}
  .day{position:relative;height:84px;background:var(--cardSoft);border:1px solid var(--line);border-radius:16px;cursor:pointer}
  .day.has{border-color:var(--accent);background:rgba(59,130,246,.12)}
  .day.today{outline:2px solid var(--accent)}
  .day .num{position:absolute;top:8px;left:0;right:0;text-align:center;font-weight:700}
  .day .badge{position:absolute;left:50%;transform:translateX(-50%);bottom:10px;text-align:center;border:1px solid var(--line);background:var(--card);width:28px;height:28px;line-height:26px;border-radius:999px}
  .detail{margin-top:10px}
</style>
</head>
<body>
<header>
  <h1>Подработки и зарплата</h1>
  <div class="tabs">
    <button class="tab active" data-tab="journal" type="button">Журнал</button>
    <button class="tab" data-tab="settings" type="button">Настройки</button>
    <button class="tab" data-tab="holidays" type="button">Праздники</button>
    <button class="tab" data-tab="archive" type="button">Архив</button>
    <button class="tab" data-tab="backup" type="button">Импорт</button>
  </div>
</header>

<main>
  <!-- ЖУРНАЛ -->
  <section class="card" data-pane="journal">
    <div class="mode-switch">
      <button class="pill active" data-mode="calendar" type="button">Календарь</button>
      <button class="pill" data-mode="list" type="button">Список</button>
    </div>

    <div class="row">
      <div class="col-4">
        <label>Дата подработки</label>
        <div class="toolbar" style="gap:8px">
          <input type="date" id="shiftDate" style="flex:1;min-width:0">
          <button class="btn small" id="todayBtn" type="button">Сегодня</button>
        </div>
      </div>
      <div class="col-4">
        <label>Тип</label>
        <select id="shiftType">
          <option value="auto">(определить автоматически)</option>
          <option value="weekday">Будни (сверхур.)</option>
          <option value="saturday">Суббота</option>
          <option value="sunday">Воскресенье</option>
          <option value="holiday">Праздник</option>
        </select>
      </div>
      <div class="col-4">
        <label>Часы</label>
        <input type="number" id="shiftHours" min="0.25" step="0.25" placeholder="напр., 3.5">
      </div>
    </div>

    <div class="toolbar" style="margin-top:10px">
      <button class="btn primary" id="addShift" type="button">Добавить</button>
      <div class="muted" id="dayInfo"></div>
    </div>

    <div class="card" style="margin-top:8px">
      <div class="muted" style="margin-bottom:8px">Быстрые кнопки:</div>
      <div class="quick-grid">
        <button class="btn" data-quick="weekday-3.5" type="button">Будни 3.5 ч</button>
        <button class="btn" data-quick="sat-8" type="button">Суббота 8 ч</button>
        <button class="btn" data-quick="sun-8" type="button">Воскресенье 8 ч</button>
        <button class="btn" data-quick="hol-8" type="button">Праздник 8 ч</button>
      </div>
    </div>

    <div class="card" id="calendarCard">
      <div class="total" id="monthTitle" style="text-align:center;margin-bottom:8px">—</div>
      <div class="toolbar nowrap" style="justify-content:space-between;margin-bottom:10px">
        <button class="btn small" id="prevMonth" type="button">◀︎ Предыдущий</button>
        <button class="btn small" id="nextMonth" type="button">Следующий ▶︎</button>
      </div>
      <div class="calendar" id="calendarGrid"></div>
      <div class="detail" id="dayDetail"></div>
    </div>

    <div class="card" id="listCard" style="display:none">
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Дата</th><th>День</th><th>Тип</th>
              <th class="right">Часы</th><th class="right">₽/ч</th><th class="right">Оплата</th><th class="right">Действия</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
          <tfoot><tr><td colspan="5" class="right">Итого подработки:</td><td class="right" id="totalOvertime">0</td><td></td></tr></tfoot>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-4">
        <div>Оклад: <span id="baseMonthlyOut">—</span></div>
        <div class="muted">Почасовая: <span id="hourlyOut">—</span> ₽/ч</div>
      </div>
      <div class="col-4">
        <div>Подработки: <span id="overtimeOut">—</span></div>
        <div class="muted">Часы подработок: <span id="otHoursOut">—</span> ч</div>
      </div>
      <div class="col-4">
        <div>Итого к выплате:</div>
        <div class="total" id="grandTotal">—</div>
      </div>
    </div>
  </section>

  <!-- НАСТРОЙКИ -->
  <section class="card" data-pane="settings" style="display:none">
    <h3>Настройки расчёта</h3>
    <div class="row">
      <div class="col-3">
        <label>Текущий месяц</label>
        <input type="month" id="monthFilter">
      </div>
      <div class="col-3">
        <label>Оклад (на руки), ₽</label>
        <input type="number" id="baseMonthly" min="0" step="1" placeholder="введите сумму">
      </div>
      <div class="col-3">
        <label>Рабочих дней (авто: Пн–Пт минус праздники)</label>
        <input id="autoWorkdays" disabled>
      </div>
      <div class="col-3">
        <label>Часов в дне</label>
        <input type="number" id="hoursPerDay" min="1" step="0.25" value="8">
      </div>
    </div>
    <div class="row">
      <div class="col-3"><label>Будни — первые 2 ч</label><input type="number" id="weekdayFirstMult" step="0.1" min="1" value="1.5"></div>
      <div class="col-3"><label>Будни — дальше</label><input type="number" id="weekdayNextMult" step="0.1" min="1" value="2"></div>
      <div class="col-3"><label>Суббота</label><input type="number" id="satMult" step="0.1" min="1" value="1.5"></div>
      <div class="col-3"><label>Воскресенье</label><input type="number" id="sunMult" step="0.1" min="1" value="2"></div>
    </div>
    <div class="row">
      <div class="col-3"><label>Праздник</label><input type="number" id="holidayMult" step="0.1" min="1" value="2"></div>
      <div class="col-3"><label>Тема</label>
        <select id="themeSelect"><option value="dark">Тёмная</option><option value="light">Светлая</option></select>
      </div>
      <div class="col-6">
        <label>Обновление приложения</label>
        <div class="toolbar">
          <button class="btn" id="updateAppBtn" type="button">Обновить приложение</button>
          <div class="muted" id="updateStatus"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- ПРАЗДНИКИ -->
  <section class="card" data-pane="holidays" style="display:none">
    <h3>Праздничные дни месяца</h3>
    <div class="muted">Текущий месяц: <b id="monthLabel"></b>. Нажмите на день, чтобы отметить/снять праздник.</div>
    <div id="holidayGrid" style="margin-top:10px"></div>
  </section>

  <!-- АРХИВ -->
  <section class="card" data-pane="archive" style="display:none">
    <h3 style="margin:0">Архив по месяцам</h3>
    <div id="archiveList" style="margin-top:10px"></div>
  </section>

  <!-- ИМПОРТ -->
  <section class="card" data-pane="backup" style="display:none">
    <h3>Импорт / Экспорт</h3>
    <div class="toolbar">
      <button class="btn" id="exportJSON" type="button">Экспорт JSON</button>
      <input id="importFile" type="file" accept="application/json" style="max-width:320px">
      <button class="btn danger" id="clearAll" type="button">Очистить всё</button>
    </div>
  </section>
</main>

<script>
// (same JS as in previous cell; omitted here for brevity in this tool output)
</script>
</body>
</html>
